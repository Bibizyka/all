
knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 1



                        1  ;prog 09.04.05 knopka15.asm
 0000                   2  RAMStart      EQU  $0040
 0000                   3  ROMStart      EQU  $8000
 0000                   4  VectorStart   EQU  $FFDC
                        5  
 0000                   6  $Include 'gpgtregs.inc'
                        7   ; 68HC908GT16/GP32 Equates
                        8  
 0000                   9  PTA    EQU $0000     ; Ports and data direction
 0000                  10  PORTA  EQU $0000
 0000                  11  PTB    EQU $0001
 0000                  12  PORTB  EQU $0001
 0000                  13  PTC    EQU $0002
 0000                  14  PORTC  EQU $0002
 0000                  15  PTD    EQU $0003
 0000                  16  PORTD  EQU $0003
 0000                  17  DDRA   EQU $0004
 0000                  18  DDRB   EQU $0005
 0000                  19  DDRC   EQU $0006
 0000                  20  DDRD   EQU $0007
 0000                  21  PTE    EQU $0008
 0000                  22  PORTE  EQU $0008
                       23  
 0000                  24  SCPSC   EQU $0009    ;GT16 Only - Enhanced SCI
 0000                  25  SCIACTL EQU $000A    ;GT16 Only
 0000                  26  SCIADAT EQU $000B    ;GT16 Only
                       27  
 0000                  28  DDRE    EQU $000C    ; Ports and data direction
                       29  
 0000                  30  PTAPUE  EQU $000D    ; Port pull-up enables
 0000                  31  PTCPUE  EQU $000E
 0000                  32  PTDPUE  EQU $000F
                       33  
 0000                  34  SPCR    EQU $0010    ; SPI (Syncronous communication
                                                                             s)
 0000                  35  SPSCR   EQU $0011
 0000                  36  SPDR    EQU $0012
                       37  
 0000                  38  SCC1    EQU $0013    ; SCI (Asyncronous communicatio
                                                                            ns)
 0000                  39  SCC2    EQU $0014
 0000                  40  SCC3    EQU $0015
 0000                  41  SCS1    EQU $0016
 0000                  42  SCS2    EQU $0017
 0000                  43  SCDR    EQU $0018
 0000                  44  SCBR    EQU $0019
                       45  
 0000                  46  INTKBSCR EQU $001a   ; Keyboard interrupt control/st
                                                                           atus
 0000                  47  INTKBIER EQU $001b
                       48  
 0000                  49  TBCR    EQU $001c    ; Time base module
                       50  
 0000                  51  INTSCR  EQU $001d    ; IRQ status/control
                       52  
 0000                  53  CONFIG2 EQU $001e    ; System configuration
 0000                  54  CONFIG1 EQU $001f
                       55  


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 2



 0000                  56  T1SC    EQU $0020    ; Timer 1
 0000                  57  T1CNTH  EQU $0021
 0000                  58  T1CNTL  EQU $0022
 0000                  59  T1MODH  EQU $0023
 0000                  60  T1MODL  EQU $0024
 0000                  61  T1SC0   EQU $0025
 0000                  62  T1CH0H  EQU $0026
 0000                  63  T1CH0L  EQU $0027
 0000                  64  T1SC1   EQU $0028
 0000                  65  T1CH1H  EQU $0029
 0000                  66  T1CH1L  EQU $002a
                       67  
 0000                  68  T2SC    EQU $002b    ; Timer 2
 0000                  69  T2CNTH  EQU $002c
 0000                  70  T2CNTL  EQU $002d
 0000                  71  T2MODH  EQU $002e
 0000                  72  T2MODL  EQU $002f
 0000                  73  T2SC0   EQU $0030
 0000                  74  T2CH0H  EQU $0031
 0000                  75  T2CH0L  EQU $0032
 0000                  76  T2SC1   EQU $0033
 0000                  77  T2CH1H  EQU $0034
 0000                  78  T2CH1L  EQU $0035
                       79  
 0000                  80  PCTL    EQU $0036    ; GP32 Only - Phase lock loop 
                                                                 (for crystals)
 0000                  81  PBWC    EQU $0037    ; GP32 Only
 0000                  82  PMSH    EQU $0038    ; GP32 Only
 0000                  83  PMSL    EQU $0039    ; GP32 Only
 0000                  84  PMRS    EQU $003A    ; GP32 Only
 0000                  85  PMDS    EQU $003B    ; GP32 Only
                       86  
 0000                  87  ICGCR   EQU $0036    ; GT16 Only - Internal Clock 
                                                                      Generator
 0000                  88  ICGMR   EQU $0037    ; GT16 Only
 0000                  89  ICGTR   EQU $0038    ; GT16 Only
 0000                  90  ICGDVR  EQU $0039    ; GT16 Only
 0000                  91  ICGDSR  EQU $003A    ; GT16 Only
 0000                  92  ICGTR5  EQU $FF80    ; GT16 Only
 0000                  93  ICGTR3  EQU $FF81    ; GT16 Only
                       94  
 0000                  95  ADSCR   EQU $003C    ; A to D converter
 0000                  96  ADR     EQU $003D
 0000                  97  ADCLK   EQU $003E
                       98  
 0000                  99  SBSR    EQU $fe00    ; System integration
 0000                 100  SRSR    EQU $fe01
 0000                 101  SUBAR   EQU $fe02
 0000                 102  SBFCR   EQU $fe03
                      103  
 0000                 104  INT1    EQU $fe04    ; Interrupt status
 0000                 105  INT2    EQU $fe05
 0000                 106  INT3    EQU $fe06
                      107  
 0000                 108  FLTCR   EQU $fe07    ; Flash test/programming
 0000                 109  FLCR    EQU $fe08
                      110  
 0000                 111  BRKH    EQU $fe09    ; Hardware breakpoint


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 3



 0000                 112  BRKL    EQU $fe0a
 0000                 113  BRKSCR  EQU $fe0b
                      114  
 0000                 115  LVISR   EQU $fe0c    ; Low voltage detect
                      116  
 0000                 117  FLBPR   EQU $ff80    ; Flash boot protect
                      118  
 0000                 119  COPCTL  EQU $ffff    ; COP (Computer operating 
                                                              properly) control
                      120  
                      121  
                      122  
                      123  ; (C)opywrite P&E Microcomputer Systems, 1998, 2002
                      124  ; http://www.pemicro.com
                      125  
                      126  
 0000                 127  LCD_CTRL      EQU  PORTC
 0000                 128  LCD_DATA      EQU  PORTC
 0000                 129  LCD_DATA_MASK EQU  $0F
 0000                 130  LCD_RS        EQU  1
 0000                 131  LCD_RW        EQU  0
 0000                 132  LCD_E         EQU  4
 0000                 133  LCD_CTRU      EQU  PORTD
                      134  
                      135  
 0040                 136          org   RAMStart
                      137  
 0040                 138  delayReg1 ds 1
 0041                 139  delayReg2 ds 1
 0042                 140  delayReg3 ds 1
 0043                 141  lcddata   ds 1
 0044                 142  time      ds 1
 0045                 143  i1        ds 1
 0046                 144  i2        ds 1
 0047                 145  i3        ds 1
 0048                 146  c0        ds 32
 007A                 147  cr        ds 1
 007B                 148  ci        ds 1 
 007C                 149  time0     ds 1
 007D                 150  flgt      ds 1
 8000                 151        org   ROMStart
                      152  
                      153  Var_Delay:
 8000 [02] A621       154         lda   #33T
 8002 [01] 4A         155  L6:    deca
 8003 [03] 26FD       156         bne   L6
 8005 [04] 3A44       157         dec   time
 8007 [03] 26F7       158         bne   Var_Delay
 8009 [04] 81         159         rts
                      160  
                      161  
                      162  LCD_Delay_40us:
 800A [02] 87         163         psha        ;2 cycles
 800B [02] A60E       164         lda   #14T  ;2 cycles
 800D [01] 4A         165  L5:    deca        ;1 cycle
 800E [03] 26FD       166         bne   L5    ;3 cycles
 8010 [02] 86         167         pula        ;2 cycles
 8011 [04] 81         168         rts         ;4 cycles


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 4



                      169  
                      170  LCD_Write_Nibble:
 8012 [02] 87         171         psha
 8013 [02] A40F       172         and   #$0F
 8015 [02] 87         173         psha
 8016 [02] 9B         174         sei
 8017 [03] B602       175         lda   LCD_DATA
 8019 [02] A4F0       176         and   #$F0
 801B [04] 9EEA01     177         ora   1,SP
 801E [03] B702       178         sta   LCD_DATA
 8020 [02] 9A         179         cli
 8021 [04] 1802       180         bset  LCD_E,LCD_CTRL
 8023 [04] 1902       181         bclr  LCD_E,LCD_CTRL
 8025 [04] ADE3       182         bsr   LCD_Delay_40us
 8027 [02] 86         183         pula
 8028 [02] 86         184         pula
 8029 [04] 81         185         rts
                      186  
                      187  
                      188  LCD_Write:
 802A [03] 62         189         nsa
 802B [04] ADE5       190         bsr   LCD_Write_Nibble
 802D [03] 62         191         nsa
 802E [04] ADE2       192         bsr   LCD_Write_Nibble
 8030 [04] 81         193         rts
                      194  
                      195  LCD_Init:
                      196  *** Wait for 15ms
 8031 [02] A696       197         lda   #150T
 8033 [03] B744       198         sta   time
 8035 [05] CD8000     199         jsr   Var_Delay
                      200  *** Send Init Command
 8038 [02] A602       201         lda   #$02
 803A [05] CD8012     202         jsr   LCD_Write_Nibble
                      203  *** Wait for 4.1ms
 803D [02] A629       204         lda   #41T
 803F [03] B744       205         sta   time
 8041 [05] CD8000     206         jsr   Var_Delay
                      207  *** Send Init Command
 8044 [02] A608       208         lda   #$08
 8046 [05] CD8012     209         jsr   LCD_Write_Nibble
                      210  *** Wait for 100 us
 8049 [02] A601       211         lda   #1
 804B [03] B744       212         sta   time
 804D [05] CD8000     213         jsr   Var_Delay
                      214  *** Send Init Command
                      215      ;   lda   #$00
                      216      ;   jsr   LCD_Write_Nibble
                      217  *** Send Function Set Command (4 bit bus, 2 rows, 
                                                                      5x7 dots)
                      218     ;    lda   #$0F
                      219     ;    jsr   LCD_Write_Nibble
 8050 [02] A60F       220         lda   #$0F
 8052 [05] CD802A     221         jsr   LCD_Write
                      222  *** Send Display Ctrl Command (display on, cursor 
                                                              off, no blinking)
 8055 [02] A628       223         lda   #$28
 8057 [05] CD802A     224         jsr   LCD_Write


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 5



                      225  *** Send Clear Display Command (clear display, 
                                                               cursor addr = 0)
 805A [02] A601       226         lda   #$01
 805C [05] CD802A     227         jsr   LCD_Write
 805F [02] A6C8       228         lda   #200T
 8061 [03] B744       229         sta   time
 8063 [05] CD8000     230         jsr   Var_Delay
                      231  *** Send Entry Mode Command (increment, no display 
                                                                         shift)
                      232  ;       lda   #$04
                      233  ;       jsr   LCD_Write
 8066 [04] 1203       234         bset  LCD_RS,LCD_CTRU
 8068 [04] 81         235         rts
                      236  
                      237  
                      238  Main_Init:
 8069 [01] 9C         239         rsp
                      240  ;       mov   #$1,CONFIG2
 806A [03] B61F       241         lda   CONFIG1
 806C [02] AA01       242         ora   #1
 806E [03] B71F       243         sta   CONFIG1
 8070 [04] 6E0E04     244         mov   #$0E,DDRA
 8073 [04] 6EF00D     245         mov   #$F0,PTAPUE
 8076 [04] 6E1F06     246         mov   #$1F,DDRC
 8079 [04] 6E0002     247         mov   #$00,PORTC
 807C [04] 6E0B07     248         mov   #$0B,DDRD
 807F [04] 6E0003     249         mov   #$00,PORTD
 8082 [03] 3F7C       250         clr   time0
 8084 [03] 3F7D       251         clr   flgt
 8086 [05] CD8031     252         jsr   LCD_Init
                      253  OPROS:
                      254  ;1-aja stroka
 8089 [03] 450048     255         ldhx  #c0
 808C [04] 6E4C7A     256         mov   #$4c,cr
 808F [04] 5E7A       257         mov   cr,x+
 8091 [04] 6E2B7A     258         mov   #$2b,cr
 8094 [04] 5E7A       259         mov   cr,x+
 8096 [04] 6E327A     260         mov   #$32,cr
 8099 [04] 5E7A       261         mov   cr,x+
 809B [04] 6E317A     262         mov   #$31,cr
 809E [04] 5E7A       263         mov   cr,x+
 80A0 [04] 6E2E7A     264         mov   #$2e,cr
 80A3 [04] 5E7A       265         mov   cr,x+
 80A5 [04] 6E317A     266         mov   #$31,cr
 80A8 [04] 5E7A       267         mov   cr,x+
 80AA [04] 6E307A     268         mov   #$30,cr
 80AD [04] 5E7A       269         mov   cr,x+
 80AF [04] 6E547A     270         mov   #$54,cr
 80B2 [04] 5E7A       271         mov   cr,x+
 80B4 [04] 6E457A     272         mov   #$45,cr
 80B7 [04] 5E7A       273         mov   cr,x+
 80B9 [04] 6E547A     274         mov   #$54,cr
 80BC [04] 5E7A       275         mov   cr,x+
 80BE [04] 6E2B7A     276         mov   #$2b,cr
 80C1 [04] 5E7A       277         mov   cr,x+
 80C3 [04] 6E317A     278         mov   #$31,cr
 80C6 [04] 5E7A       279         mov   cr,x+
 80C8 [04] 6E397A     280         mov   #$39,cr


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 6



 80CB [04] 5E7A       281         mov   cr,x+
 80CD [04] 6E2E7A     282         mov   #$2e,cr
 80D0 [04] 5E7A       283         mov   cr,x+
 80D2 [04] 6E387A     284         mov   #$38,cr
 80D5 [04] 5E7A       285         mov   cr,x+
 80D7 [04] 6E387A     286         mov   #$38,cr
 80DA [04] 5E7A       287         mov   cr,x+
                      288  ;2-aja stroka
 80DC [04] 6E487A     289         mov   #$48,cr
 80DF [04] 5E7A       290         mov   cr,x+
 80E1 [04] 6E2B7A     291         mov   #$2b,cr
 80E4 [04] 5E7A       292         mov   cr,x+
 80E6 [04] 6E327A     293         mov   #$32,cr
 80E9 [04] 5E7A       294         mov   cr,x+
 80EB [04] 6E317A     295         mov   #$31,cr
 80EE [04] 5E7A       296         mov   cr,x+
 80F0 [04] 6E2E7A     297         mov   #$2e,cr
 80F3 [04] 5E7A       298         mov   cr,x+
 80F5 [04] 6E387A     299         mov   #$38,cr
 80F8 [04] 5E7A       300         mov   cr,x+
 80FA [04] 6E307A     301         mov   #$30,cr
 80FD [04] 5E7A       302         mov   cr,x+
 80FF [04] 6E4F7A     303         mov   #$4f,cr
 8102 [04] 5E7A       304         mov   cr,x+
 8104 [04] 6E467A     305         mov   #$46,cr
 8107 [04] 5E7A       306         mov   cr,x+
 8109 [04] 6E467A     307         mov   #$46,cr
 810C [04] 5E7A       308         mov   cr,x+
 810E [04] 6E2D7A     309         mov   #$2d,cr
 8111 [04] 5E7A       310         mov   cr,x+
 8113 [04] 6E2D7A     311         mov   #$2d,cr
 8116 [04] 5E7A       312         mov   cr,x+
 8118 [04] 6E2D7A     313         mov   #$2d,cr
 811B [04] 5E7A       314         mov   cr,x+
 811D [04] 6E2D7A     315         mov   #$2d,cr
 8120 [04] 5E7A       316         mov   cr,x+
 8122 [04] 6E2D7A     317         mov   #$2d,cr
 8125 [04] 5E7A       318         mov   cr,x+
 8127 [04] 6E2D7A     319         mov   #$2d,cr
 812A [04] 5E7A       320         mov   cr,x+
 812C [04] 6E2D7A     321         mov   #$2d,cr
 812F [04] 5E7A       322         mov   cr,x+
 8131 [04] 6E6620     323         mov   #$66,T1SC
 8134 [04] 1B20       324         bclr  5,T1SC
 8136 [02] 9A         325         cli
                      326  ;Clear Display i ustanov kursora na 0
 8137 [04] 1303       327         bclr  LCD_RS,LCD_CTRU
 8139 [02] A601       328         lda   #$01
 813B [05] CD802A     329         jsr   LCD_Write
 813E [02] A6C8       330         lda   #200T
 8140 [03] B744       331         sta   time
 8142 [05] CD8000     332         jsr   Var_Delay
                      333  ;Delay 0,5 sek
                      334  loop:
 8145 [02] A6FF       335       lda #$FF
 8147 [03] B745       336       sta i1
                      337  L8:
 8149 [02] A632       338       lda #50T


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 7



 814B [03] B744       339       sta time
 814D [05] CD8000     340       jsr Var_Delay
 8150 [05] 3B45F6     341       dbnz i1,L8
 8153 [02] A622       342       lda   #34T
 8155 [03] B746       343       sta   i2
 8157 [01] 8C         344       clrh
 8158 [01] 5F         345       clrx
                      346  L9:
 8159 [03] B646       347       lda i2
 815B [02] A122       348       cmp #34T
 815D [03] 2715       349       beq lm01
 815F [02] A111       350       cmp #17T
 8161 [03] 2715       351       beq lm03
 8163 [04] 1203       352       bset LCD_RS,LCD_CTRU
 8165 [03] E648       353       lda c0,x
 8167 [05] CD802A     354       jsr LCD_Write
 816A [02] A664       355       lda #100T
 816C [03] B744       356       sta time
 816E [05] CD8000     357       jsr Var_Delay
 8171 [01] 5C         358       incx
 8172 [03] 2012       359       bra lm00
                      360  lm01:
 8174 [02] A680       361       lda #$80
 8176 [03] 2002       362       bra lm02
                      363  lm03:
 8178 [02] A6A8       364       lda #$A8
                      365  lm02:
 817A [04] 1303       366       bclr LCD_RS,LCD_CTRU
 817C [05] CD802A     367       jsr LCD_Write
 817F [02] A664       368       lda #100T
 8181 [03] B744       369       sta time
 8183 [05] CD8000     370       jsr Var_Delay
                      371  lm00:
 8186 [05] 3B46D0     372       dbnz i2,L9
 8189 [01] 8C         373       clrh
 818A [01] 5F         374       clrx
 818B [02] A61F       375       lda  #31T
 818D [03] B745       376       sta  i1
 818F [05] 4E487A     377       mov  c0,cr
                      378  lm04:
                      379  ;     lda  c0+1,x
                      380   ;    sta  c0,x
 8192 [01] 5C         381       incx
 8193 [05] 3B45FC     382       dbnz i1,lm04
 8196 [03] B67A       383       lda  cr
                      384    ;   sta  c0,x
 8198 [03] B603       385       lda  PORTD
 819A [02] A808       386       eor  #$08
 819C [03] B703       387       sta  PORTD
 819E [03] 450048     388       ldhx #c0
 81A1 [02] AF17       389       aix  #23T
 81A3 [02] A508       390       bit  #$08
 81A5 [03] 270F       391       beq  lm05
 81A7 [04] 6E207A     392       mov  #$20,cr
 81AA [04] 5E7A       393       mov  cr,x+
 81AC [04] 6E4F7A     394       mov  #$4f,cr
 81AF [04] 5E7A       395       mov  cr,x+
 81B1 [04] 6E4E7A     396       mov  #$4e,cr


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 8



 81B4 [03] 200A       397       bra  lm07
                      398  lm05:
 81B6 [04] 6E4F7A     399       mov  #$4f,cr
 81B9 [04] 5E7A       400       mov  cr,x+
 81BB [04] 6E467A     401       mov  #$46,cr
 81BE [04] 5E7A       402       mov  cr,x+
                      403  lm07:
 81C0 [04] 5E7A       404       mov  cr,x+
 81C2 [03] 2081       405       bra  loop
                      406  PROVERKA:
 81C4 [05] CD81D7     407       jsr PRB4
 81C7 [02] AB03       408       add #3T
 81C9 [05] CD81E4     409       jsr PRB5
 81CC [02] AB03       410       add #3T
 81CE [05] CD81F1     411       jsr PRB6
 81D1 [02] AB03       412       add #3T
 81D3 [05] CD81FE     413       jsr PRB7
 81D6 [04] 81         414       rts
                      415  
                      416  
                      417  PRB4:
 81D7 [05] 090003     418       brclr 4,PTA,L1
 81DA [03] CC81E3     419       jmp K1
 81DD [05] CD802A     420  L1:  jsr LCD_Write
 81E0 [05] 0900FD     421  B1:  brclr 4,PTA,B1
 81E3 [04] 81         422  K1:  rts
                      423  
                      424  PRB5:
 81E4 [05] 0B0003     425       brclr 5,PTA,L2
 81E7 [03] CC81F0     426       jmp K2
 81EA [05] CD802A     427  L2:  jsr LCD_Write
 81ED [05] 0B00FD     428  B2:  brclr 5,PTA,B2
 81F0 [04] 81         429  K2:  rts
                      430  
                      431  PRB6:
 81F1 [05] 0D0003     432       brclr 6,PTA,L3
 81F4 [03] CC81FD     433       jmp K3
 81F7 [05] CD802A     434  L3:  jsr LCD_Write
 81FA [05] 0D00FD     435  B3:  brclr 6,PTA,B3
 81FD [04] 81         436  K3:  rts
                      437  
                      438  PRB7:
 81FE [05] 0F0003     439       brclr 7,PTA,L4
 8201 [03] CC822B     440       jmp K5
 8204 [02] A13A       441  L4:  cmp #$3A
 8206 [03] 270B       442       beq E1
 8208 [02] A13B       443       cmp #$3B
 820A [03] 270F       444       beq E2
 820C [02] A13C       445       cmp #$3C
 820E [03] 2713       446       beq E3
 8210 [03] CC8228     447       jmp K4
 8213 [02] A601       448  E1:  lda #1T
 8215 [05] CD822C     449       jsr comand
 8218 [03] CC8228     450       jmp K4
 821B [02] A630       451  E2:  lda #$30
 821D [05] CD802A     452       jsr LCD_Write
 8220 [03] CC8228     453       jmp K4
 8223 [02] A602       454  E3:  lda #2T


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 9



 8225 [05] CD822C     455       jsr comand
 8228 [05] 0F00FD     456  K4:  brclr 7,PTA,K4
 822B [04] 81         457  K5:  rts
                      458  
                      459  
                      460  comand:
 822C [04] 1303       461       bclr LCD_RS,LCD_CTRU
 822E [05] CD802A     462       jsr  LCD_Write
 8231 [04] 1203       463       bset LCD_RS,LCD_CTRU
 8233 [04] 81         464       rts
                      465  t1_isr:
 8234 [02] 8B         466       pshh
 8235 [03] B620       467       lda  T1SC
 8237 [02] A47F       468       and  #$7f
 8239 [03] B720       469       sta  T1SC
                      470  ;     inc  time0
                      471   ;    lda  #10T
                      472    ;   cbeq time0,mt100
                      473     ;  bra  iret
                      474  mt100:
 823B [03] 3F7C       475       clr  time0
 823D [03] B67D       476       lda  flgt
 823F [02] A801       477       eor  #$01
 8241 [03] B77D       478       sta  flgt
 8243 [03] 450048     479       ldhx #c0
 8246 [02] AF0B       480       aix  #11T
 8248 [02] A501       481       bit  #$01
 824A [03] 2715       482       beq  mt101
 824C [04] 6E327B     483       mov  #$32,ci
 824F [04] 5E7B       484       mov  ci,x+
 8251 [04] 6E307B     485       mov  #$30,ci
 8254 [04] 5E7B       486       mov  ci,x+
 8256 [01] 5C         487       incx
 8257 [04] 6E357B     488       mov  #$35,ci
 825A [04] 5E7B       489       mov  ci,x+
 825C [04] 6E337B     490       mov  #$33,ci
 825F [03] 2010       491       bra  mt102
                      492  mt101:
 8261 [04] 6E317B     493       mov  #$31,ci
 8264 [04] 5E7B       494       mov  ci,x+
 8266 [04] 6E397B     495       mov  #$39,ci
 8269 [04] 5E7B       496       mov  ci,x+
 826B [01] 5C         497       incx
 826C [04] 6E387B     498       mov  #$38,ci
 826F [04] 5E7B       499       mov  ci,x+
                      500  mt102:
 8271 [04] 5E7B       501       mov  ci,x+ 
                      502  iret:
 8273 [02] 8A         503       pulh
 8274 [07] 80         504       rti
                      505  Dummy_Isr:
 8275 [07] 80         506         rti              ; Return
                      507  
                      508  
                      509  ****************************************************
                                                    ***************************
                      510  * Vectors section                                   
                                                                              *


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 10



                      511  ****************************************************
                                                    ***************************
 FFDC                 512         org  VectorStart
                      513  
 FFDC      8275       514         dw  Dummy_Isr    ; Time Base Vector
 FFDE      8275       515         dw  Dummy_Isr    ; ADC Conversion Complete
 FFE0      8275       516         dw  Dummy_Isr    ; Keyboard Vector
 FFE2      8275       517         dw  Dummy_Isr    ; SCI Transmit Vector
 FFE4      8275       518         dw  Dummy_Isr    ; SCI Receive Vector
 FFE6      8275       519         dw  Dummy_Isr    ; SCI Error Vector
 FFE8      8275       520         dw  Dummy_Isr    ; SPI Transmit Vector
 FFEA      8275       521         dw  Dummy_Isr    ; SPI Receive Vector
 FFEC      8275       522         dw  Dummy_Isr    ; TIM2 Overflow Vector
 FFEE      8275       523         dw  Dummy_Isr    ; TIM2 Channel 1 Vector
 FFF0      8275       524         dw  Dummy_Isr    ; TIM2 Channel 0 Vector
 FFF2      8234       525         dw  t1_isr    ; TIM1 Overflow Vector
 FFF4      8275       526         dw  Dummy_Isr    ; TIM1 Channel 1 Vector
 FFF6      8275       527         dw  Dummy_Isr    ; TIM1 Channel 0 Vector
 FFF8      8275       528         dw  Dummy_Isr    ; PLL Vector
 FFFA      8275       529         dw  Dummy_Isr    ; ~IRQ1 Vector
 FFFC      8275       530         dw  Dummy_Isr    ; SWI Vector
 FFFE      8069       531         dw  Main_Init    ; Reset Vector
                      532  
                      533  
                      534   

 Symbol Table 

ADCLK            003E
ADR              003D
ADSCR            003C
B1               81E0
B2               81ED
B3               81FA
BRKH             FE09
BRKL             FE0A
BRKSCR           FE0B
C0               0048
CI               007B
COMAND           822C
CONFIG1          001F
CONFIG2          001E
COPCTL           FFFF
CR               007A
DDRA             0004
DDRB             0005
DDRC             0006
DDRD             0007
DDRE             000C
DELAYREG1        0040
DELAYREG2        0041
DELAYREG3        0042
DUMMY_ISR        8275
E1               8213
E2               821B
E3               8223
FLBPR            FF80
FLCR             FE08


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 11



FLGT             007D
FLTCR            FE07
I1               0045
I2               0046
I3               0047
ICGCR            0036
ICGDSR           003A
ICGDVR           0039
ICGMR            0037
ICGTR            0038
ICGTR3           FF81
ICGTR5           FF80
INT1             FE04
INT2             FE05
INT3             FE06
INTKBIER         001B
INTKBSCR         001A
INTSCR           001D
IRET             8273
K1               81E3
K2               81F0
K3               81FD
K4               8228
K5               822B
L1               81DD
L2               81EA
L3               81F7
L4               8204
L5               800D
L6               8002
L8               8149
L9               8159
LCDDATA          0043
LCD_CTRL         0002
LCD_CTRU         0003
LCD_DATA         0002
LCD_DATA_MASK    000F
LCD_DELAY_40US   800A
LCD_E            0004
LCD_INIT         8031
LCD_RS           0001
LCD_RW           0000
LCD_WRITE        802A
LCD_WRITE_NIBBLE 8012
LM00             8186
LM01             8174
LM02             817A
LM03             8178
LM04             8192
LM05             81B6
LM07             81C0
LOOP             8145
LVISR            FE0C
MAIN_INIT        8069
MT100            823B
MT101            8261
MT102            8271
OPROS            8089


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 12



PBWC             0037
PCTL             0036
PMDS             003B
PMRS             003A
PMSH             0038
PMSL             0039
PORTA            0000
PORTB            0001
PORTC            0002
PORTD            0003
PORTE            0008
PRB4             81D7
PRB5             81E4
PRB6             81F1
PRB7             81FE
PROVERKA         81C4
PTA              0000
PTAPUE           000D
PTB              0001
PTC              0002
PTCPUE           000E
PTD              0003
PTDPUE           000F
PTE              0008
RAMSTART         0040
ROMSTART         8000
SBFCR            FE03
SBSR             FE00
SCBR             0019
SCC1             0013
SCC2             0014
SCC3             0015
SCDR             0018
SCIACTL          000A
SCIADAT          000B
SCPSC            0009
SCS1             0016
SCS2             0017
SPCR             0010
SPDR             0012
SPSCR            0011
SRSR             FE01
SUBAR            FE02
T1CH0H           0026
T1CH0L           0027
T1CH1H           0029
T1CH1L           002A
T1CNTH           0021
T1CNTL           0022
T1MODH           0023
T1MODL           0024
T1SC             0020
T1SC0            0025
T1SC1            0028
T1_ISR           8234
T2CH0H           0031
T2CH0L           0032
T2CH1H           0034


knopka23.asm           Assembled with CASM08Z  10.04.05  2:24:14  PAGE 13



T2CH1L           0035
T2CNTH           002C
T2CNTL           002D
T2MODH           002E
T2MODL           002F
T2SC             002B
T2SC0            0030
T2SC1            0033
TBCR             001C
TIME             0044
TIME0            007C
VAR_DELAY        8000
VECTORSTART      FFDC
